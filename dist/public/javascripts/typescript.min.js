var GlobalMethods=function(){function e(){}return e.prototype.ifValEmpty=function(e){for(var t=0;t<e.length;t++)if(""===e.eq(t).val())return!0;return!1},e.prototype.hintErrInpt=function(e){return e.addClass("input-err-hint"),e},e.prototype.enterPressFakeClick=function(e,t){return e.on("keypress",function(e){13!==e.keyCode||t.prop("disabled")||t.trigger("click")}),e},e.prototype.getUrlParam=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!==n?decodeURI(n[2]):null},e}(),glb=new GlobalMethods,PublicMethods=function(){function e(){}return e.prototype.navSlide=function(){function e(){var e=$(".nav .more-operate .more-oprate-items"),t=$(".nav .more-operate .fa-ellipsis-v");$(".nav .more-operate .nav-alink").on("mouseenter",function(){e.slideDown("fast"),console.log(t),t.addClass("nav-more-rotate")}),$(".nav .more-operate").on("mouseleave",function(){e.slideUp("fast"),t.removeClass("nav-more-rotate")})}function t(e){e.on("click",function(){$.ajax({type:"POST",url:"/logout",data:{info:"logout"},dataType:"json",success:function(e){console.log("success logout",e),window.location.href="/login"},error:function(e){console.log("logout ajax err",e)},complete:function(){console.log("logout complete")}})})}e(),t($(".nav .nav-ul .more-operate .log-out"))},e.prototype.getPosition=function(){localStorage.clear(),localStorage.getItem("tempusername")||$.ajax({type:"GET",url:"/ip-address",dataType:"json",success:function(e){console.log("ip address is ",e),$.ajax({type:"GET",dataType:"jsonp",crossDomain:!0,url:"http://api.map.baidu.com/location/ip?ak=papzu8GfZQdx0lAGOdi2vM29oGVyaZ6t&ip="+e.ipAddress+"&coor=bd09ll",success:function(t){if(console.log(t),0===t.status)if(t.content.address_detail.province){var n=t.content.address_detail.city?t.content.address_detail.city:t.content.address_detail.province,o=n+"网友";console.log(o),localStorage.setItem("tempusername",o),localStorage.setItem("ipaddress",e.ipAddress)}else console.log("地址不明"),localStorage.setItem("tempusername","中国网友"),localStorage.setItem("ipaddress",e.ipAddress);else console.log("地址不明"),localStorage.setItem("tempusername","墙外网友"),localStorage.setItem("ipaddress",e.ipAddress)},error:function(e){console.log("err when getting from baidu ip api 从百度api获取地理位置时发生错误:",e)},complete:function(){}})},error:function(e){console.log("get ip address error 获取ip地址时发生错误：",e)},complete:function(){}})},e}(),pub=new PublicMethods,ExecutePages=function(){function e(){}return e.prototype.edit=function(){function e(){$(".edit-input").on("keyup mouseup touchend",function(){console.log(glb.ifValEmpty($(".edit-input"))),glb.ifValEmpty($(".edit-input"))?$(".button-block .as-btn").prop("disabled",!0):$(".button-block .as-btn").prop("disabled",!1)})}function t(){$.ajax({type:"POST",url:"/get-article-content",data:{id:o},dataType:"json",success:function(e){"get success"===e.info?(console.log(e.result),$(".origin-title .edit-input").val(e.result.oTitle),$(".origin-author .edit-input").val(e.result.oAuthor),$(".origin-time .edit-input").val(e.result.oTime.split("T")[0]),$(".origin-content .edit-input").val(e.result.oContent),$(".trans-title .edit-input").val(e.result.tTitle),$(".trans-author .edit-input").val(e.result.tAuthor),$(".trans-time .edit-input").val(e.result.tTime.split("T")[0]),$(".trans-cover .edit-input").val(e.result.coverPic),$(".trans-content .edit-input").val(e.result.tContent)):alert("发生了错误 Σ(;ﾟдﾟ)")},error:function(e){console.log("ajax err",e)},complete:function(){console.log("ajax complete")}})}function n(){var e,t,n,o,a,s,c,l,i,r;$(".button-block .as-btn").on("click",function(){$(this).prop("disabled",!0),e=$.trim($(".origin-title .edit-input").val()),t=$(".origin-author .edit-input").val(),n=$(".origin-time .edit-input").val(),o=$(".origin-content .edit-input").val(),a=$.trim($(".trans-title .edit-input").val()),s=$(".trans-author .edit-input").val(),c=$(".trans-time .edit-input").val(),l=$(".trans-cover .edit-input").val(),i=$(".trans-content .edit-input").val(),r={oTitle:e,oAuthor:t,oTime:n,oContent:o,tTitle:a,tAuthor:s,tTime:c,coverPic:l,tContent:i};var m=JSON.stringify(r),p=$(this).attr("updatefor");console.log(m),$.ajax({type:"POST",url:"/editupload",data:{data:m,id:p},dataType:"json",success:function(e){console.log("success",e),"creat success"===e.info?(alert("创建成功"),window.location.href="/article-manage"):"update success"===e.info?(alert("修改成功"),window.location.href="/article-manage"):alert("好像哪里发生错误了 ...(｡•ˇ‸ˇ•｡) ...")},error:function(e){console.log("ajax err",e),alert("创建失败 错误："+e)},complete:function(){function e(){$(".button-block .as-btn").prop("disabled",!1)}console.log("ajax complete"),setTimeout(e,2e3)}})})}var o=glb.getUrlParam("articleid");e(),n(),pub.navSlide(),o?t():null},e.prototype.about=function(){function e(){var e,t=0;$(".about-image-container img").on("click",function(){t++,console.log(t);var e=$(this);3===t?function(){e.trigger("willChange"),t=0}():null}),$(".about-image-container img").on("willChange",function(){function t(){n.parent().removeClass("avartor-alter"),console.log("remove ani")}console.log("trogger chage"),clearTimeout(e);var n=$(this);n.parent().addClass("avartor-alter"),e=setTimeout(t,5100)})}pub.navSlide(),e()},e.prototype.login=function(){function e(){glb.enterPressFakeClick($("body"),$(".login-btn-container .as-btn"))}function t(){function e(){glb.ifValEmpty($(".login-area label input"))?$(".login-btn-container .as-btn").prop("disabled",!0):$(".login-btn-container .as-btn").prop("disabled",!1)}$(".login-area label input").on("keyup mouseup touchend",function(){$(this).removeClass("input-err-hint"),e()}),e()}function n(){var e,t,n;$(".login-btn-container .as-btn").on("click",function(){$(".login-area label input").blur(),$(this).prop("disabled",!0),e=$(".account-label .login-account").val(),t=$(".password-label .login-password").val(),n={account:e,password:t},$.ajax({type:"POST",url:"/login",data:n,dataType:"json",success:function(e){console.log("success",e),"wrong account"===e.info?glb.hintErrInpt($(".login-area .input-container .account-label .login-account")):"incorrect password"===e.info?glb.hintErrInpt($(".login-area .input-container .password-label .login-password")):"login success"===e.info&&(window.location.href="/article-manage")},error:function(e){console.log("login ajax err",e)},complete:function(){function e(){$(".login-btn-container .as-btn").prop("disabled",!1)}console.log("ajax complete"),setTimeout(e,2e3)}})})}pub.navSlide(),t(),n(),e()},e.prototype.article=function(){function e(e){e.append('<a class="fa fa-commenting reply-for-comments"></a>')}function t(){$(".comments-of-class1").on("click",".fa-commenting",function(){var e=$(this);if(e.after('<div class="reply-area" style="display:none"><input placeholder="说点什么吧..."><button disabled="disabled">评论</button></div>').next(".reply-area").slideDown("fast").prev(".reply-for-comments").removeClass("fa-commenting").addClass("fa-comment"),"true"===e.parent(".class1-comment").attr("fold")){var t=e.parent(".class1-comment").attr("comment-id");console.log("need unfold",t),$.ajax({type:"POST",url:"/get-comments",data:{in_id:t},dataType:"json",success:function(t){if(console.log("success",t),"get comments success"===t.info){if(t.data.length>0){e.parents(".class1-comment").append('<ul class="comments-of-class2"></ul>');for(var n="",o=0,a=t.data;o<a.length;o++){var s=a[o];n+='<li class="class2-comment" comment-id="'+s._id+'" comment-name="'+s.tempName+'"><i class="fa fa-user"></i><span class="comment-name"><a>'+s.tempName+"</a>@<a>"+s.followedName+':</a></span><span class="comment-content">'+s.content+'</span><a class="fa fa-commenting reply-for-comments"></a></li>'}e.parents(".class1-comment").find(".comments-of-class2").prepend(n),e.parents(".class1-comment").attr("fold","false")}}else alert("好像哪里发生错误了 ...(｡•ˇ‸ˇ•｡) ...")},error:function(e){console.log("comment article ajax err",e),alert("好像发生错误了 ...(｡•ˇ‸ˇ•｡) ..."+e.responseText)},complete:function(){}})}}),$(".comments-of-class1").on("click",".fa-comment",function(){$(this).next(".reply-area").slideUp("fast",function(){$(this).prev(".reply-for-comments").removeClass("fa-comment").addClass("fa-commenting").next(".reply-area").remove()})})}function n(){$(".article-comments-area").on("keyup mouseup touchend change"," .reply-area input",function(){console.log(glb.ifValEmpty($(this))),glb.ifValEmpty($(this))?$(this).next("button").prop("disabled",!0):$(this).next("button").prop("disabled",!1)})}function o(e,t,n){$.ajax({type:"POST",url:"/get-comments",data:{for_id:e,in_id:t},dataType:"json",success:function(e){console.log("success",e),"get comments success"===e.info?n(e):alert("好像哪里发生错误了 ...(｡•ˇ‸ˇ•｡) ...")},error:function(e){console.log("comment article ajax err",e),alert("好像发生错误了 ...(｡•ˇ‸ˇ•｡) ..."+e.responseText)},complete:function(){}})}function a(){function e(){$(".article-comments-area").on("click",".reply-area-for-article button",function(){var e=$(this),t=e.prev("input").val(),n=e.parents(".article-comments-area").attr("article-id"),o=n,a=$(".main-article .main-title").html();e.prop("disabled",!0);var s={content:t,in_id:n,for_id:o,ipAddr:localStorage.getItem("ipaddress"),followedName:a,tempName:localStorage.getItem("tempusername")};$.ajax({type:"POST",url:"/comment-post",data:s,dataType:"json",success:function(t){console.log("success",t),"comment post success"===t.info?($(".comments-of-class1").prepend('<li comment-id="'+t.id+'"  comment-name="'+s.tempName+'" fold=true class="class1-comment"><i class="fa fa-user"></i><span class="comment-name"><a>'+s.tempName+':</a></span><span class="comment-content">'+s.content+'</span><a class="fa fa-commenting reply-for-comments"></a></li>'),e.prev("input").val("")):alert("好像哪里发生错误了 ...(｡•ˇ‸ˇ•｡) ...")},error:function(e){console.log("comment article ajax err",e),alert("好像发生错误了 ...(｡•ˇ‸ˇ•｡) ..."+e.responseText)},complete:function(){}})})}function t(){$(".article-comments-area").on("click",".class1-comment .reply-area button",function(){var e=$(this),t=e.prev("input").val(),n=e.parents(".class1-comment").attr("comment-id"),o=e.parent(".reply-area").parent("li").attr("comment-id"),a=e.parent(".reply-area").parent("li").attr("comment-name"),s={content:t,followedName:a,in_id:n,for_id:o,ipAddr:localStorage.getItem("ipaddress"),tempName:localStorage.getItem("tempusername")},c=e.parent(".reply-area").parent("li").attr("comment-name");e.prop("disabled",!0),console.log(s),$.ajax({type:"POST",url:"/comment-post",data:s,dataType:"json",success:function(t){console.log("success",t),"comment post success"===t.info?(e.prev("input").val(""),0===e.parents(".class1-comment").find(".comments-of-class2").length&&e.parents(".class1-comment").append('<ul class="comments-of-class2"></ul>'),e.parents(".class1-comment").find(".comments-of-class2").prepend('<li class="class2-comment" comment-id="'+t.id+'" comment-name="'+s.tempName+'"><i class="fa fa-user"></i><span class="comment-name"><a>'+s.tempName+"</a>@<a>"+c+':</a></span><span class="comment-content">'+s.content+'</span><a class="fa fa-commenting reply-for-comments"></a></li>')):alert("好像哪里发生错误了 ...(｡•ˇ‸ˇ•｡) ...")},error:function(e){console.log("comment article ajax err",e),alert("好像发生错误了 ...(｡•ˇ‸ˇ•｡) ..."+e.responseText)},complete:function(){}})})}e(),t()}function s(){function e(){var e=$(".article-comments-area").attr("article-id"),t=e;o(e,t,function(e){for(var t="",n=0,o=e.data;n<o.length;n++){var a=o[n];t+='<li class="class1-comment" comment-id="'+a._id+'" comment-name="'+a.tempName+'" fold=true><i class="fa fa-user"></i><span class="comment-name"><a>'+a.tempName+':</a></span><span class="comment-content">'+a.content+'</span><a class="fa fa-commenting reply-for-comments"></a></li>'}$(".comments-of-class1").prepend(t)})}e()}e($(".article-comments-area .class1-comment,.article-comments-area .class2-comment")),t(),n(),a(),s(),pub.getPosition(),pub.navSlide()},e.prototype.articleManage=function(){function e(e){e.slideUp("fast",function(){e.remove()})}function t(){var t=$(".article-content .manage-btns .btn-delete");t.on("click",function(){var t=$(this).parents(".article-display"),n=$(this).parents(".article-content").attr("article_id");return confirm("删除后不可恢复，确定删除？")?void $.ajax({type:"POST",url:"/article-remove",data:{articleId:n},dataType:"json",success:function(n){console.log("success",n),"delete error"===n.info?alert("出错啦 (⊙⊙！) "):"delete success"===n.info&&e(t)},error:function(e){console.log("delete ajax err",e)},complete:function(){}}):!1})}t(),pub.navSlide()},e.prototype.start=function(){pub.navSlide()},e}(),exec=new ExecutePages;
/* app @version v1.0.0 @date 05-27-2016  15:59:22 */

/**AUTHOR:Lam**/
/**EMAIL:1422015387@QQ.COM**/
/**OR whatisurname7@GMAIL.COM**/
//# sourceMappingURL=../maps/typescript.min.js.map
